{% extends "dashbase.html" %}

{% block styles %}
{{super()}}
  <link rel="stylesheet" href="{{url_for('static', filename='clock.css')}}">
{% endblock %}


{% block app_content %}


<div class="row justify-content-between">
    <div class="card-col-6">
      <div class="card-header">
        Last image
      </div>
    </div>
    <!-- <div class="card col-2">-->
    <div class="card" style="width: 130px;">
      <div class="card-header">
        Time
      </div>
      <div class="clock mx-auto my-3">
        <div class="clock__second"></div>
        <div class="clock__minute"></div>
        <div class="clock__hour"></div>
        <div class="clock__axis"></div>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
          <section class="clock__indicator"></section>
      </div>
    </div>
</div>

<hr>



    <div style="margin-top:50px" class="mainbox">
      <div class="panel panel-info">
          <div class="panel-heading">
              <div class="panel-title">Total Activity</div>
          </div>
          <div class="panel-body">
            <div class="row">
              <label class="col-md-1 control-label">
                Today:
              </label>
            </div>
            <div class="row">
              <label class="col-md-offset-1 col-md-1 control-label">
                Image(s)
              </label>
              <div class="col-md-1">
                {{activity.get_today_images()}}
              </div>
              <label class="col-md-1 control-label">
                Error(s)
              </label>
              <div class="col-md-1">
                {{activity.get_today_errors()}}
              </div>
              <label class="col-md-1 control-label">
                Submit(s)
              </label>
              <div class="col-md-1">
                {{activity.get_today_submits()}}
              </div>
              <label class="col-md-2 control-label">
                Render time
              </label>
              <div class="col-md-1">
                {{'%0.1f'| format(activity.get_today_render_time().total_seconds())}}s
              </div>
            </div>
            <div class="row">
              <label class="col-md-1 control-label">
                Total:
              </label>
            </div>
            <div class="row">
              <label class="col-md-offset-1 col-md-1 control-label">
                Image(s)
              </label>
              <div class="col-md-1">
                {{activity.get_total_images()}}
              </div>
              <label class="col-md-1 control-label">
                Error(s)
              </label>
              <div class="col-md-1">
                {{activity.get_total_errors()}}
              </div>
              <label class="col-md-1 control-label">
                Submit(s)
              </label>
              <div class="col-md-1">
                {{activity.get_total_submits()}}
              </div>
              <label class="col-md-2 control-label">
                Render time
              </label>
              <div class="col-md-1">
                {{'%0.1f'| format(activity.get_total_render_time().total_seconds())}}s
              </div>
            </div>
          </div>
      </div>
    </div>

    <div style="margin-top:50px" class="mainbox">
      <div class="panel panel-info">
          <div class="panel-heading">
              <div class="panel-title">Running projects</div>
          </div>
          <div class="panel-body">
            <div class="table-responsive">
              <div id="running_projects">
              </div>
            </div>
          </div>
      </div>
    </div>

    <div style="margin-top:50px" class="mainbox">
      <div class="panel panel-info">
          <div class="panel-heading">
              <div class="panel-title">Queue</div>
          </div>
          <div class="panel-body">
            <div class="table-responsive">
              <div id="running_queue">
              </div>
            </div>
          </div>
      </div>
    </div>

{% endblock %}

{% block scripts %}
{{super()}}

<script src="{{url_for('static', filename='clock.js')}}"></script>

{# ajax code #}
<script>

  function update_data() {
    $.get("/ajax/running_data", function(data) {
      $("#running_projects").html(data.projects);
      $("#running_queue").html(data.queue);
    });
  }

  function update_data_cycle() {

    update_data();
    window.setTimeout(update_data_cycle, 60*1000);
  }

  // initial call
  $(document).ready(function() {
  // executes when HTML-Document is loaded and DOM is ready
    update_data_cycle();
  });
</script>

{% endblock %}
